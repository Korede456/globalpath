{% include 'jobseeker/base.html' %}
{% block content %}
<div class="container mx-auto p-4">
    <h1 class="text-2xl font-bold text-center mb-6">Available Jobs</h1>

    <!-- Search Field -->
    <div class="flex justify-center mb-6">
        <input 
            type="text" 
            name="search" 
            placeholder="Search for jobs..." 
            class="w-full max-w-lg p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-600"
        >
    </div>

    <!-- Filters Section -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
        <!-- Job Type Filter -->
        <select 
            name="job_type" 
            class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-600">
            <option value="">Job Type</option>
            {% for key, value in job.JOB_TYPE_CHOICES %}
                <option value="{{ key }}">{{ value }}</option>
            {% endfor %}
        </select>

        <!-- Schedule Filter -->
        <select 
            name="schedule" 
            class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-600">
            <option value="">Schedule</option>
            {% for key, value in job.SCHEDULE_CHOICES %}
                <option value="{{ key }}">{{ value }}</option>
            {% endfor %}
        </select>

        <!-- Career Level Filter -->
        <select 
            name="career_level" 
            class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-600">
            <option value="">Career Level</option>
            {% for key, value in job.CAREER_LEVEL_CHOICES %}
                <option value="{{ key }}">{{ value }}</option>
            {% endfor %}
        </select>

        <!-- Category Filter -->
        <select 
            name="category" 
            class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-600">
            <option value="">Category</option>
            {% for category in categories %}
                <option value="{{ category.id }}">{{ category.name }}</option>
            {% endfor %}
        </select>
    </div>

    <!-- Job Listings and Details -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Job Listings on the Left -->
        <div class="bg-white shadow rounded-lg p-4">
            <ul class="space-y-4">
                {% for job in jobs %}
                <li class="border-b pb-4 cursor-pointer" onclick="showJobDetails('{{ job.id }}')">
                    <h2 class="text-xl font-semibold text-indigo-600">{{ job.title }}</h2>
                    <p class="text-gray-500">
                        {% if job.time_posted.date == today %}
                            Today {{ job.time_posted|time:"H:i" }}
                        {% else %}
                            {{ job.time_posted|date:"M d, Y" }}
                        {% endif %}
                    </p>
                    <p class="text-gray-700">{{ job.description|truncatewords:30 }}</p>
                </li>
                {% empty %}
                <li>No jobs available at the moment.</li>
                {% endfor %}
            </ul>
        </div>

        <!-- Job Details on the Right -->
        <div id="jobDetails" class="bg-white shadow rounded-lg p-4 hidden lg:block">
            <h2 class="text-2xl font-bold mb-4" id="jobTitle"></h2>
            <p id="jobDescription"></p>
        </div>
    </div>
</div>

<!-- Mobile Styles: Job details overlay -->
<div id="jobDetailsMobile" class="fixed inset-0 bg-white p-4 hidden lg:hidden">
    <button 
        class="text-indigo-600 font-bold text-lg mb-4" 
        onclick="hideJobDetails()">Back to Listings</button>
    <h2 class="text-2xl font-bold mb-4" id="jobTitleMobile"></h2>
    <p id="jobDescriptionMobile"></p>
</div>

<script>
    // JavaScript to show job details dynamically
    function showJobDetails(jobId) {
        // Get job details (In a real app, this would be an AJAX call)
        var jobs = {
            {% for job in jobs %}
            "{{ job.id }}": {
                "title": "{{ job.title }}",
                "description": "{{ job.description|escapejs }}",
            },
            {% endfor %}
        };

        if (jobs[jobId]) {
            document.getElementById('jobTitle').textContent = jobs[jobId].title;
            document.getElementById('jobDescription').textContent = jobs[jobId].description;

            document.getElementById('jobTitleMobile').textContent = jobs[jobId].title;
            document.getElementById('jobDescriptionMobile').textContent = jobs[jobId].description;

            document.getElementById('jobDetails').classList.remove('hidden');
            document.getElementById('jobDetailsMobile').classList.remove('hidden');
        }
    }

    function hideJobDetails() {
        document.getElementById('jobDetailsMobile').classList.add('hidden');
    }
</script>
{% endblock %}
